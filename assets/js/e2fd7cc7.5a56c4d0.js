"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4008],{10342:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"guides/architecture/load-balancing","title":"Load Balanced Hosting","description":"If you are load balancing across a set of web servers (e.g. a Web Farm) your certificate options include:","source":"@site/docs/guides/architecture/load-balanced-hosting.md","sourceDirName":"guides/architecture","slug":"/guides/architecture/load-balancing","permalink":"/docs/guides/architecture/load-balancing","draft":false,"unlisted":false,"editUrl":"https://github.com/webprofusion/certify-docs/edit/master/docs/guides/architecture/load-balanced-hosting.md","tags":[],"version":"current","frontMatter":{"id":"load-balancing","title":"Load Balanced Hosting"},"sidebar":"docSidebar","previous":{"title":"Apache, nginx etc","permalink":"/docs/guides/apache-nginx"},"next":{"title":"Import & Export","permalink":"/docs/guides/import-export"}}');var a=t(74848),o=t(28453);const r={id:"load-balancing",title:"Load Balanced Hosting"},s="Load Balanced Hosting",c={},l=[{value:"Domain Validation",id:"domain-validation",level:2},{value:"Testing",id:"testing",level:2},{value:"Windows (IIS) Deployment Strategies",id:"windows-iis-deployment-strategies",level:2},{value:"Centralized Certificate Store (CCS)",id:"centralized-certificate-store-ccs",level:3},{value:"Azure",id:"azure",level:2},{value:"Apache (Windows or Linux)",id:"apache-windows-or-linux",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.header,{children:(0,a.jsx)(i.h1,{id:"load-balanced-hosting",children:"Load Balanced Hosting"})}),"\n",(0,a.jsx)(i.p,{children:"If you are load balancing across a set of web servers (e.g. a Web Farm) your certificate options include:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:"have each server manage it's own certificates"}),"\n",(0,a.jsx)(i.li,{children:"centrally renewing certificates, then copying the certificates to each server"}),"\n",(0,a.jsx)(i.li,{children:"terminating TLS on a web application firewall or reverse proxy."}),"\n"]}),"\n",(0,a.jsx)(i.p,{children:"Additionally you need to decide:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:"how to perform domain validation (via http or dns)."}),"\n",(0,a.jsx)(i.li,{children:"whether to centrally manage certificate renewals or perform renewals on each individual server."}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"domain-validation",children:"Domain Validation"}),"\n",(0,a.jsx)(i.p,{children:"Http validation requires correctly answering an http challenge from the certificate authority which can be more difficult in load balanced scenarios because the wrong server is likely to respond. DNS validation instead updates a TXT record value in your domains DNS (this requires automated access to your DNS provider or CNAME delegation to a zone/service which allows automation)."}),"\n",(0,a.jsxs)(i.p,{children:["If you can only use http validation you will require a web application firewall or reverse proxy server in order to ensure all ",(0,a.jsx)(i.code,{children:"http://<your domain>/.well-known/acme-challenge/"})," requests go to the correct server (the one requesting the renewal). DNS validation is generally easier in this scenario."]}),"\n",(0,a.jsx)(i.h2,{id:"testing",children:"Testing"}),"\n",(0,a.jsx)(i.p,{children:"You should try out your intended deployment strategy on a set of test machines to you can learn how each of part is configured and practice sharing a certificate between multiple machines/sites."}),"\n",(0,a.jsx)(i.h2,{id:"windows-iis-deployment-strategies",children:"Windows (IIS) Deployment Strategies"}),"\n",(0,a.jsx)(i.h3,{id:"centralized-certificate-store-ccs",children:"Centralized Certificate Store (CCS)"}),"\n",(0,a.jsx)(i.p,{children:"Centralized Certificate Store (CCS) is a feature you can enable in Windows to allow certificates to be dynamically loaded from a shared path."}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsx)(i.p,{children:"CCS allows you to store certificates on a network shared location and for IIS to automatically pick these up and use the latest file on any machine with access to the file."}),"\n"]}),"\n",(0,a.jsxs)(i.li,{children:["\n",(0,a.jsx)(i.p,{children:'use the "Deploy to CCS" task to write out your certificate PFX file to a UNC share which all the machines have access to (or have multiple tasks and write to a share on each machine).'}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(i.p,{children:["This requires that you manage your own https bindings in IIS (configured for CCS) as the standard built-in https deployment in ",(0,a.jsx)(i.em,{children:"Certify Certificate Manager"}),' does not configure CCS enabled https bindings for you (and you should use a deployment mode of "Certificate Store Only" or "No Deployment" as "Auto" would instead try to setup the https bindings for you).']}),"\n",(0,a.jsxs)(i.p,{children:["There is also a general guide to ",(0,a.jsx)(i.a,{href:"/docs/deployment/tasks/ccs",children:"using CCS with Certify Certificate Manager"})," on Windows."]}),"\n",(0,a.jsx)(i.p,{children:"These recommendations assume you are simply load balancing your DNS name across multiple web servers (virtual machines etc)."}),"\n",(0,a.jsx)(i.h2,{id:"azure",children:"Azure"}),"\n",(0,a.jsx)(i.p,{children:"If you are using any specific Azure functionality (azure web apps, web application gateway etc) the app has a Task which enables you to Deploy to Azure Key Vault (if you do use this you need to set a password on the PFX) - from there you can reference this certificate from multiple azure services."}),"\n",(0,a.jsx)(i.h2,{id:"apache-windows-or-linux",children:"Apache (Windows or Linux)"}),"\n",(0,a.jsx)(i.p,{children:"You can use the Deploy To Apache task to copy your certificate files to a remote machine using SSH/SFTP."})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,i,t)=>{t.d(i,{R:()=>r,x:()=>s});var n=t(96540);const a={},o=n.createContext(a);function r(e){const i=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);